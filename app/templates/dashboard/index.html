{% extends "dashboard/base.html" %}

{% block title %}Dashboard - ODiGO{% endblock %}
{% block dashboard_content %}
<!-- Welcome Section -->
<section class="bg-gradient-to-r from-indigo-700 to-indigo-500 text-white rounded-2xl p-6 sm:p-8 mb-6 relative overflow-hidden">
  <div class="absolute inset-0 opacity-10">
    <svg class="w-full h-full" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid slice">
      <pattern id="pattern" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse">
        <circle cx="10" cy="10" r="1" fill="white" />
      </pattern>
      <rect width="100%" height="100%" fill="url(#pattern)" />
    </svg>
  </div>
  <div class="relative z-10 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
    <div>
      <h1 class="text-2xl sm:text-3xl font-bold">
        Welcome back, {{ current_user.name or 'Chef' }} ğŸ‘¨â€ğŸ³
      </h1>
      <p class="text-indigo-100 text-sm sm:text-base mt-1">Discover global flavors and create magic in your kitchen!</p>
    </div>
    <div class="bg-white/20 border border-white/30 backdrop-blur-sm px-5 py-3 rounded-xl text-center">
      <div class="text-3xl font-bold text-yellow-300">{{ total_recipes }}</div>
      <p class="text-xs text-indigo-100">Your Recipes</p>
    </div>
  </div>
</section>

<!-- Quick Actions -->
<section class="grid grid-cols-2 sm:grid-cols-4 gap-3 sm:gap-4 mb-6">
  {% set actions = [
    {'color': 'from-indigo-500 to-purple-600', 'title': 'My Recipes', 'icon': 'fa-solid fa-book-bookmark', 'url': url_for('dashboard.my_recipes'), 'desc': total_recipes ~ ' recipes'},
    {'color': 'from-green-500 to-emerald-600', 'title': 'Explore', 'icon': 'fa-solid fa-compass', 'url': url_for('dashboard.explore'), 'desc': 'Discover recipes'},
    {'color': 'from-orange-500 to-yellow-500', 'title': 'Add Recipe', 'icon': 'fa-solid fa-plus', 'url': url_for('dashboard.add_recipe'), 'desc': 'Share yours'},
    {'color': 'from-pink-600 to-rose-600', 'title': 'Favorites', 'icon': 'fa-solid fa-heart', 'url': '#', 'desc': 'Saved recipes'}
  ] %}
  {% for a in actions %}
  <a href="{{ a.url }}" class="p-4 rounded-xl bg-gradient-to-br {{ a.color }} text-white text-center transition-all hover:scale-105">
    <div class="bg-white/20 w-10 h-10 flex items-center justify-center rounded-lg mx-auto mb-2">
      <i class="{{ a.icon }} w-5 h-5"></i>
    </div>
    <div class="font-semibold text-sm">{{ a.title }}</div>
    <div class="text-xs text-indigo-100 mt-0.5">{{ a.desc }}</div>
  </a>
  {% endfor %}
</section>

<!-- Categories -->
<section class="mb-6">
  <div class="flex items-center justify-between mb-3">
    <h2 class="text-lg font-bold text-gray-800">Categories</h2>
    <a href="#" class="text-indigo-600 text-sm hover:underline">View all</a>
  </div>
  <div class="grid grid-cols-4 sm:grid-cols-6 md:grid-cols-8 gap-2">
    {% for emoji, label in [('ğŸ','Pasta'),('ğŸ¥—','Salads'),('ğŸ²','Soups'),('ğŸ¥˜','Curry'),('ğŸœ','Noodles'),('ğŸ£','Sushi'),('ğŸ§','Desserts'),('ğŸ”¥','Trending')] %}
    <div class="p-2 sm:p-3 bg-gray-50 rounded-xl text-center hover:bg-indigo-50 transition">
      <div class="text-lg mb-1">{{ emoji }}</div>
      <div class="text-[11px] font-medium text-gray-700">{{ label }}</div>
    </div>
    {% endfor %}
  </div>
</section>

<!-- My Recent Recipes -->
{% if user_recipes %}
<section class="mb-6">
  <div class="flex justify-between items-center mb-3">
    <h2 class="text-lg font-bold text-gray-800">My Recent Recipes</h2>
    <a href="{{ url_for('dashboard.my_recipes') }}" class="text-indigo-600 text-sm hover:underline">View all â†’</a>
  </div>
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
    {% for recipe in user_recipes %}
    <div class="bg-white rounded-xl border border-gray-100 hover:border-indigo-200 overflow-hidden transition">
      {% if recipe.images %}
      <img src="{{ recipe.images[0].url }}" alt="{{ recipe.name }}" class="w-full h-36 object-cover">
      {% endif %}
      <div class="p-4">
        <h3 class="font-semibold text-gray-800 truncate">{{ recipe.name }}</h3>
        {% if recipe.description %}
        <p class="text-gray-600 text-sm line-clamp-2 mt-1">{{ recipe.description|striptags|truncate(80) }}</p>
        {% endif %}
        <div class="text-xs text-gray-500 mt-2 flex justify-between">
          <span>{{ recipe.created_at.strftime('%b %d, %Y') }}</span>
          {% if recipe.category %}
          <span class="bg-gray-100 px-2 py-0.5 rounded-full">{{ recipe.category.name }}</span>
          {% endif %}
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</section>
{% endif %}

<!-- Recommendations -->
<section class="mb-8">
  <div class="flex items-center justify-between mb-3">
    <h2 class="text-lg font-bold text-gray-800">Recommended for You</h2>
    <a href="{{ url_for('dashboard.explore') }}" class="text-indigo-600 text-sm hover:underline">See more â†’</a>
  </div>
  <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3">
    {% for recipe in recommended_recipes %}
    <a href="{{ url_for('dashboard.view_recipe', recipe_id=recipe.id) }}" class="bg-white rounded-xl border border-gray-100 hover:border-indigo-200 overflow-hidden transition">
      {% if recipe.images %}
      <img src="{{ recipe.images[0].url }}" class="w-full h-32 object-cover" alt="{{ recipe.name }}">
      {% endif %}
      <div class="p-3">
        <h3 class="text-sm font-semibold text-gray-800 truncate">{{ recipe.name }}</h3>
        <p class="text-xs text-gray-500 mt-1 truncate">by {{ recipe.author.name or 'Chef' }}</p>
      </div>
    </a>
    {% endfor %}
  </div>
</section>
{% endblock %}

